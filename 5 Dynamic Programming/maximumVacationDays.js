// Can optimize to use linear space